

-- =====================================================================================
-- Author:		Richard Edwards
-- Create date: 4/15/2016
-- Description:	DQM stored procedure for S_TBNSALEINVENTORY table in Realware_ODS
-- =====================================================================================


/*
DQM RULES FOR:
TABLE:  S_TBNSALEINVENTORY

1. RECEPTIONNO – Cannot be null and must be 10 or less characters

2. ACCOUNTNO - Must exist in s_tblacct - FK check

3. SALEDATE - must be a valid date in sql server

4. SALEPRICE – must be gt or = to zero





*/

CREATE PROCEDURE [dqm].[dqm_s_tbnsaleinventory]
	

AS
BEGIN

    DECLARE @lv_RUNTIME  DATETIME=GETDATE()

	  BEGIN
	

     --Begin DQM checks for the table for each row.

----------------------------------------------------------------------------------

-- RECEPTIONNO – must not be null and must be 10 or less characters

		INSERT INTO [dqm].[s_tbnsaleinventory_err]
	([COLUMN_NAME],
	[DQM_RULE],
	[ERROR_DESCRIPTION],
	[DQM_RUN_DATE],
	[RECEPTIONNO],
	[ACCOUNTNO],
	[PARCELNO],
	[INVENTORYEFFECTIVEDATE],
	[SALEDATE],
	[SALEPRICE],
	[ADJSALEPRICE],
	[SALEVALUEPER],
	[ACCTTYPE],
	[ECONOMICAREACODE],
	[LEA],
	[SUBDIVISION],
	[VALUEAREACODE],
	[PROPERTYTYPE],
	[IMPCONDITIONTYPE],
	[IMPQUALITY],
	[IMPABSTRACTCODE],
	[BLTASDESCRIPTION],
	[BLTASYEARBUILT],
	[PHYSICALAGE],
	[ADJUSTEDYEARBUILT],
	[EFFECTIVEAGE],
	[IMPEXTERIOR],
	[CLASSCODE],
	[IMPCOUNT],
	[BLTASTOTALUNITCOUNT],
	[ROOMCOUNT],
	[BEDROOMCOUNT],
	[BATHCOUNT],
	[FIXTURECOUNT],
	[TOTALIMPSF],
	[RESIDENTIALSF],
	[COMMERCIALSF],
	[CONDOIMPSF],
	[OUTBUILDINGSF],
	[IMPBLTASOTHER],
	[LANDNETSF],
	[MULTIPLEUSEFLAG],
	[LANDTYPE],
	[LANDABSTRACTCODE],
	[LANDCERTIFICATIONCODE],
	[LANDGROSSACRECOUNT],
	[LANDGROSSSF],
	[LANDGROSSFF],
	[LANDGROSSUNITCOUNT],
	[ZONINGCODE],
	[PLATTEDFLAG],
	[UNITNAME],
	[ACCTADJSALEVALUEPER],
	[TOTALLANDVALUETIMEOFSALE],
	[TOTALACCTVALUETIMEOFSALE],
	[PRIORYEARTAXROLLACTUALAMT],
	[PRIORYEARTAXROLLASSESSED],
	[LANDNETACRECOUNT],
	[HVACTYPE],
	[IMPUNITTYPE],
	[IMPINTERIOR],
	[ROOFCOVER],
	[ROOFTYPE],
	[INVENTORYOVERRIDEFLAG],
	[ZONEDAREA],
	[NBHDCODE1],
	[NBHDCODE2],
	[NBHDCODE3],
	[NBHDCODE4],
	[NBHDEXTENSION1],
	[NBHDEXTENSION2],
	[NBHDEXTENSION3],
	[NBHDEXTENSION4],
	[OCCCODE1],
	[OCCCODE2],
	[OCCCODE3],
	[ACCTADJSALEPRICE],
	[TIMEADJSALEPRICE],
	[DEEDCODE],
	[VALID1FLAG],
	[VALID2FLAG],
	[EXCLUDECODE1],
	[EXCLUDECODE2],
	[IMPROVEDFLAG],
	[CONFIRMEDFLAG],
	[BUSINESSNAME],
	[STREETNO],
	[PREDIRECTION],
	[STREETNAME],
	[STREETTYPE],
	[POSTDIRECTION],
	[PROPERTYCITY],
	[PROPERTYZIPCODE],
	[OUTBUILDINGCOUNT],
	[LANDEXCESSSF],
	[APPROACHTYPE],
	[FLOORCOVER],
	[CONDOIMPPERCENT],
	[FINALSF],
	[FINALSFVALUEPER],
	[ZONEDAREAVALUEPER],
	[GROUPINVENTORYFLAG],
	[GRANTORNAME1],
	[GRANTORNAME2],
	[GRANTORADDRESS1],
	[GRANTORADDRESS2],
	[GRANTORCITY],
	[GRANTORSTATECODE],
	[GRANTORZIPCODE],
	[SUBDIVISIONNAME],
	[LOT],
	[BLOCK],
	[FILINGNO],
	[TRACT],
	[LEGALDESCRIPTION],
	[GRANTEENAME1],
	[GRANTEENAME2],
	[GRANTEEADDRESS1],
	[GRANTEEADDRESS2],
	[GRANTEECITY],
	[GRANTEESTATECODE],
	[GRANTEEZIPCODE],
	[SALEINVENTORYON0],
	[SALEINVENTORYON1],
	[SALEINVENTORYON2],
	[OCCCODEDESCRIPTION1],
	[OCCCODEDESCRIPTION2],
	[OCCCODEDESCRIPTION3],
	[SALEINVENTORYOD0],
	[SALEINVENTORYOD1],
	[SALEINVENTORYOM0],
	[SALEINVENTORYOM1],
	[SALEINVENTORYOT0],
	[SALEINVENTORYOT1],
	[LANDNETFF],
	[JURISDICTIONID],
	[OUTOFAREASALEJURISDICTION],
	[LASTUPDATED],
	[GRANTEEPROVINCE],
	[GRANTEECOUNTRY],
	[GRANTEEPOSTALCODE],
	[OCCCOMPLETEDPCT],
	[PRIMARYUSECODE],
	[GRANTORPROVINCE],
	[GRANTORCOUNTRY],
	[GRANTORPOSTALCODE],
	[LANDNETUNITCOUNT],
	[TOTALFINISHEDSF],
	[TOTALUNFINISHEDSF],
	[BLTASCODE],
	[SALERATIO])
	    SELECT 
				'RECEPTIONNO',
				'NOT NULL AND FIELD LENGTH RESTRICTION',
				'RECEPTIONNO MUST NOT BE NULL AND MUST BE 10 CHARACTERS OR LESS',
				@lv_RUNTIME,
	[RECEPTIONNO],
	[ACCOUNTNO],
	[PARCELNO],
	[INVENTORYEFFECTIVEDATE],
	[SALEDATE],
	[SALEPRICE],
	[ADJSALEPRICE],
	[SALEVALUEPER],
	[ACCTTYPE],
	[ECONOMICAREACODE],
	[LEA],
	[SUBDIVISION],
	[VALUEAREACODE],
	[PROPERTYTYPE],
	[IMPCONDITIONTYPE],
	[IMPQUALITY],
	[IMPABSTRACTCODE],
	[BLTASDESCRIPTION],
	[BLTASYEARBUILT],
	[PHYSICALAGE],
	[ADJUSTEDYEARBUILT],
	[EFFECTIVEAGE],
	[IMPEXTERIOR],
	[CLASSCODE],
	[IMPCOUNT],
	[BLTASTOTALUNITCOUNT],
	[ROOMCOUNT],
	[BEDROOMCOUNT],
	[BATHCOUNT],
	[FIXTURECOUNT],
	[TOTALIMPSF],
	[RESIDENTIALSF],
	[COMMERCIALSF],
	[CONDOIMPSF],
	[OUTBUILDINGSF],
	[IMPBLTASOTHER],
	[LANDNETSF],
	[MULTIPLEUSEFLAG],
	[LANDTYPE],
	[LANDABSTRACTCODE],
	[LANDCERTIFICATIONCODE],
	[LANDGROSSACRECOUNT],
	[LANDGROSSSF],
	[LANDGROSSFF],
	[LANDGROSSUNITCOUNT],
	[ZONINGCODE],
	[PLATTEDFLAG],
	[UNITNAME],
	[ACCTADJSALEVALUEPER],
	[TOTALLANDVALUETIMEOFSALE],
	[TOTALACCTVALUETIMEOFSALE],
	[PRIORYEARTAXROLLACTUALAMT],
	[PRIORYEARTAXROLLASSESSED],
	[LANDNETACRECOUNT],
	[HVACTYPE],
	[IMPUNITTYPE],
	[IMPINTERIOR],
	[ROOFCOVER],
	[ROOFTYPE],
	[INVENTORYOVERRIDEFLAG],
	[ZONEDAREA],
	[NBHDCODE1],
	[NBHDCODE2],
	[NBHDCODE3],
	[NBHDCODE4],
	[NBHDEXTENSION1],
	[NBHDEXTENSION2],
	[NBHDEXTENSION3],
	[NBHDEXTENSION4],
	[OCCCODE1],
	[OCCCODE2],
	[OCCCODE3],
	[ACCTADJSALEPRICE],
	[TIMEADJSALEPRICE],
	[DEEDCODE],
	[VALID1FLAG],
	[VALID2FLAG],
	[EXCLUDECODE1],
	[EXCLUDECODE2],
	[IMPROVEDFLAG],
	[CONFIRMEDFLAG],
	[BUSINESSNAME],
	[STREETNO],
	[PREDIRECTION],
	[STREETNAME],
	[STREETTYPE],
	[POSTDIRECTION],
	[PROPERTYCITY],
	[PROPERTYZIPCODE],
	[OUTBUILDINGCOUNT],
	[LANDEXCESSSF],
	[APPROACHTYPE],
	[FLOORCOVER],
	[CONDOIMPPERCENT],
	[FINALSF],
	[FINALSFVALUEPER],
	[ZONEDAREAVALUEPER],
	[GROUPINVENTORYFLAG],
	[GRANTORNAME1],
	[GRANTORNAME2],
	[GRANTORADDRESS1],
	[GRANTORADDRESS2],
	[GRANTORCITY],
	[GRANTORSTATECODE],
	[GRANTORZIPCODE],
	[SUBDIVISIONNAME],
	[LOT],
	[BLOCK],
	[FILINGNO],
	[TRACT],
	[LEGALDESCRIPTION],
	[GRANTEENAME1],
	[GRANTEENAME2],
	[GRANTEEADDRESS1],
	[GRANTEEADDRESS2],
	[GRANTEECITY],
	[GRANTEESTATECODE],
	[GRANTEEZIPCODE],
	[SALEINVENTORYON0],
	[SALEINVENTORYON1],
	[SALEINVENTORYON2],
	[OCCCODEDESCRIPTION1],
	[OCCCODEDESCRIPTION2],
	[OCCCODEDESCRIPTION3],
	[SALEINVENTORYOD0],
	[SALEINVENTORYOD1],
	[SALEINVENTORYOM0],
	[SALEINVENTORYOM1],
	[SALEINVENTORYOT0],
	[SALEINVENTORYOT1],
	[LANDNETFF],
	[JURISDICTIONID],
	[OUTOFAREASALEJURISDICTION],
	[LASTUPDATED],
	[GRANTEEPROVINCE],
	[GRANTEECOUNTRY],
	[GRANTEEPOSTALCODE],
	[OCCCOMPLETEDPCT],
	[PRIMARYUSECODE],
	[GRANTORPROVINCE],
	[GRANTORCOUNTRY],
	[GRANTORPOSTALCODE],
	[LANDNETUNITCOUNT],
	[TOTALFINISHEDSF],
	[TOTALUNFINISHEDSF],
	[BLTASCODE],
	[SALERATIO]
			FROM [asr_staging].[s_tbnsaleinventory]
			WHERE RECEPTIONNO IS NULL OR LEN(RECEPTIONNO) > 10;

------------------------------------------------------------------------------

   -- ACCOUNTNO - Not null and must exist in s_tblacct - FK check

INSERT INTO [dqm].[s_tbnsaleinventory_err]
	([COLUMN_NAME],
	[DQM_RULE],
	[ERROR_DESCRIPTION],
	[DQM_RUN_DATE],
	[RECEPTIONNO],
	[ACCOUNTNO],
	[PARCELNO],
	[INVENTORYEFFECTIVEDATE],
	[SALEDATE],
	[SALEPRICE],
	[ADJSALEPRICE],
	[SALEVALUEPER],
	[ACCTTYPE],
	[ECONOMICAREACODE],
	[LEA],
	[SUBDIVISION],
	[VALUEAREACODE],
	[PROPERTYTYPE],
	[IMPCONDITIONTYPE],
	[IMPQUALITY],
	[IMPABSTRACTCODE],
	[BLTASDESCRIPTION],
	[BLTASYEARBUILT],
	[PHYSICALAGE],
	[ADJUSTEDYEARBUILT],
	[EFFECTIVEAGE],
	[IMPEXTERIOR],
	[CLASSCODE],
	[IMPCOUNT],
	[BLTASTOTALUNITCOUNT],
	[ROOMCOUNT],
	[BEDROOMCOUNT],
	[BATHCOUNT],
	[FIXTURECOUNT],
	[TOTALIMPSF],
	[RESIDENTIALSF],
	[COMMERCIALSF],
	[CONDOIMPSF],
	[OUTBUILDINGSF],
	[IMPBLTASOTHER],
	[LANDNETSF],
	[MULTIPLEUSEFLAG],
	[LANDTYPE],
	[LANDABSTRACTCODE],
	[LANDCERTIFICATIONCODE],
	[LANDGROSSACRECOUNT],
	[LANDGROSSSF],
	[LANDGROSSFF],
	[LANDGROSSUNITCOUNT],
	[ZONINGCODE],
	[PLATTEDFLAG],
	[UNITNAME],
	[ACCTADJSALEVALUEPER],
	[TOTALLANDVALUETIMEOFSALE],
	[TOTALACCTVALUETIMEOFSALE],
	[PRIORYEARTAXROLLACTUALAMT],
	[PRIORYEARTAXROLLASSESSED],
	[LANDNETACRECOUNT],
	[HVACTYPE],
	[IMPUNITTYPE],
	[IMPINTERIOR],
	[ROOFCOVER],
	[ROOFTYPE],
	[INVENTORYOVERRIDEFLAG],
	[ZONEDAREA],
	[NBHDCODE1],
	[NBHDCODE2],
	[NBHDCODE3],
	[NBHDCODE4],
	[NBHDEXTENSION1],
	[NBHDEXTENSION2],
	[NBHDEXTENSION3],
	[NBHDEXTENSION4],
	[OCCCODE1],
	[OCCCODE2],
	[OCCCODE3],
	[ACCTADJSALEPRICE],
	[TIMEADJSALEPRICE],
	[DEEDCODE],
	[VALID1FLAG],
	[VALID2FLAG],
	[EXCLUDECODE1],
	[EXCLUDECODE2],
	[IMPROVEDFLAG],
	[CONFIRMEDFLAG],
	[BUSINESSNAME],
	[STREETNO],
	[PREDIRECTION],
	[STREETNAME],
	[STREETTYPE],
	[POSTDIRECTION],
	[PROPERTYCITY],
	[PROPERTYZIPCODE],
	[OUTBUILDINGCOUNT],
	[LANDEXCESSSF],
	[APPROACHTYPE],
	[FLOORCOVER],
	[CONDOIMPPERCENT],
	[FINALSF],
	[FINALSFVALUEPER],
	[ZONEDAREAVALUEPER],
	[GROUPINVENTORYFLAG],
	[GRANTORNAME1],
	[GRANTORNAME2],
	[GRANTORADDRESS1],
	[GRANTORADDRESS2],
	[GRANTORCITY],
	[GRANTORSTATECODE],
	[GRANTORZIPCODE],
	[SUBDIVISIONNAME],
	[LOT],
	[BLOCK],
	[FILINGNO],
	[TRACT],
	[LEGALDESCRIPTION],
	[GRANTEENAME1],
	[GRANTEENAME2],
	[GRANTEEADDRESS1],
	[GRANTEEADDRESS2],
	[GRANTEECITY],
	[GRANTEESTATECODE],
	[GRANTEEZIPCODE],
	[SALEINVENTORYON0],
	[SALEINVENTORYON1],
	[SALEINVENTORYON2],
	[OCCCODEDESCRIPTION1],
	[OCCCODEDESCRIPTION2],
	[OCCCODEDESCRIPTION3],
	[SALEINVENTORYOD0],
	[SALEINVENTORYOD1],
	[SALEINVENTORYOM0],
	[SALEINVENTORYOM1],
	[SALEINVENTORYOT0],
	[SALEINVENTORYOT1],
	[LANDNETFF],
	[JURISDICTIONID],
	[OUTOFAREASALEJURISDICTION],
	[LASTUPDATED],
	[GRANTEEPROVINCE],
	[GRANTEECOUNTRY],
	[GRANTEEPOSTALCODE],
	[OCCCOMPLETEDPCT],
	[PRIMARYUSECODE],
	[GRANTORPROVINCE],
	[GRANTORCOUNTRY],
	[GRANTORPOSTALCODE],
	[LANDNETUNITCOUNT],
	[TOTALFINISHEDSF],
	[TOTALUNFINISHEDSF],
	[BLTASCODE],
	[SALERATIO])
	    SELECT 
				'ACCOUNTNO',
				'ACCOUNTNO MUST EXIST IN ACCOUNT TABLE - FK CHECK',
				'ACCOUNTNO MUST EXIST IN TABLE S_TBLACCT',
				@lv_RUNTIME,
	[RECEPTIONNO],
	[ACCOUNTNO],
	[PARCELNO],
	[INVENTORYEFFECTIVEDATE],
	[SALEDATE],
	[SALEPRICE],
	[ADJSALEPRICE],
	[SALEVALUEPER],
	[ACCTTYPE],
	[ECONOMICAREACODE],
	[LEA],
	[SUBDIVISION],
	[VALUEAREACODE],
	[PROPERTYTYPE],
	[IMPCONDITIONTYPE],
	[IMPQUALITY],
	[IMPABSTRACTCODE],
	[BLTASDESCRIPTION],
	[BLTASYEARBUILT],
	[PHYSICALAGE],
	[ADJUSTEDYEARBUILT],
	[EFFECTIVEAGE],
	[IMPEXTERIOR],
	[CLASSCODE],
	[IMPCOUNT],
	[BLTASTOTALUNITCOUNT],
	[ROOMCOUNT],
	[BEDROOMCOUNT],
	[BATHCOUNT],
	[FIXTURECOUNT],
	[TOTALIMPSF],
	[RESIDENTIALSF],
	[COMMERCIALSF],
	[CONDOIMPSF],
	[OUTBUILDINGSF],
	[IMPBLTASOTHER],
	[LANDNETSF],
	[MULTIPLEUSEFLAG],
	[LANDTYPE],
	[LANDABSTRACTCODE],
	[LANDCERTIFICATIONCODE],
	[LANDGROSSACRECOUNT],
	[LANDGROSSSF],
	[LANDGROSSFF],
	[LANDGROSSUNITCOUNT],
	[ZONINGCODE],
	[PLATTEDFLAG],
	[UNITNAME],
	[ACCTADJSALEVALUEPER],
	[TOTALLANDVALUETIMEOFSALE],
	[TOTALACCTVALUETIMEOFSALE],
	[PRIORYEARTAXROLLACTUALAMT],
	[PRIORYEARTAXROLLASSESSED],
	[LANDNETACRECOUNT],
	[HVACTYPE],
	[IMPUNITTYPE],
	[IMPINTERIOR],
	[ROOFCOVER],
	[ROOFTYPE],
	[INVENTORYOVERRIDEFLAG],
	[ZONEDAREA],
	[NBHDCODE1],
	[NBHDCODE2],
	[NBHDCODE3],
	[NBHDCODE4],
	[NBHDEXTENSION1],
	[NBHDEXTENSION2],
	[NBHDEXTENSION3],
	[NBHDEXTENSION4],
	[OCCCODE1],
	[OCCCODE2],
	[OCCCODE3],
	[ACCTADJSALEPRICE],
	[TIMEADJSALEPRICE],
	[DEEDCODE],
	[VALID1FLAG],
	[VALID2FLAG],
	[EXCLUDECODE1],
	[EXCLUDECODE2],
	[IMPROVEDFLAG],
	[CONFIRMEDFLAG],
	[BUSINESSNAME],
	[STREETNO],
	[PREDIRECTION],
	[STREETNAME],
	[STREETTYPE],
	[POSTDIRECTION],
	[PROPERTYCITY],
	[PROPERTYZIPCODE],
	[OUTBUILDINGCOUNT],
	[LANDEXCESSSF],
	[APPROACHTYPE],
	[FLOORCOVER],
	[CONDOIMPPERCENT],
	[FINALSF],
	[FINALSFVALUEPER],
	[ZONEDAREAVALUEPER],
	[GROUPINVENTORYFLAG],
	[GRANTORNAME1],
	[GRANTORNAME2],
	[GRANTORADDRESS1],
	[GRANTORADDRESS2],
	[GRANTORCITY],
	[GRANTORSTATECODE],
	[GRANTORZIPCODE],
	[SUBDIVISIONNAME],
	[LOT],
	[BLOCK],
	[FILINGNO],
	[TRACT],
	[LEGALDESCRIPTION],
	[GRANTEENAME1],
	[GRANTEENAME2],
	[GRANTEEADDRESS1],
	[GRANTEEADDRESS2],
	[GRANTEECITY],
	[GRANTEESTATECODE],
	[GRANTEEZIPCODE],
	[SALEINVENTORYON0],
	[SALEINVENTORYON1],
	[SALEINVENTORYON2],
	[OCCCODEDESCRIPTION1],
	[OCCCODEDESCRIPTION2],
	[OCCCODEDESCRIPTION3],
	[SALEINVENTORYOD0],
	[SALEINVENTORYOD1],
	[SALEINVENTORYOM0],
	[SALEINVENTORYOM1],
	[SALEINVENTORYOT0],
	[SALEINVENTORYOT1],
	[LANDNETFF],
	[JURISDICTIONID],
	[OUTOFAREASALEJURISDICTION],
	[LASTUPDATED],
	[GRANTEEPROVINCE],
	[GRANTEECOUNTRY],
	[GRANTEEPOSTALCODE],
	[OCCCOMPLETEDPCT],
	[PRIMARYUSECODE],
	[GRANTORPROVINCE],
	[GRANTORCOUNTRY],
	[GRANTORPOSTALCODE],
	[LANDNETUNITCOUNT],
	[TOTALFINISHEDSF],
	[TOTALUNFINISHEDSF],
	[BLTASCODE],
	[SALERATIO]
			FROM [asr_staging].[s_tbnsaleinventory] si
			WHERE NOT EXISTS
				(SELECT 1 FROM asr_staging.s_tblacct a
				WHERE si.ACCOUNTNO = a.ACCOUNTNO);
--------------------------------------------------------------------------------

INSERT INTO [dqm].[s_tbnsaleinventory_err]
	([COLUMN_NAME],
	[DQM_RULE],
	[ERROR_DESCRIPTION],
	[DQM_RUN_DATE],
	[RECEPTIONNO],
	[ACCOUNTNO],
	[PARCELNO],
	[INVENTORYEFFECTIVEDATE],
	[SALEDATE],
	[SALEPRICE],
	[ADJSALEPRICE],
	[SALEVALUEPER],
	[ACCTTYPE],
	[ECONOMICAREACODE],
	[LEA],
	[SUBDIVISION],
	[VALUEAREACODE],
	[PROPERTYTYPE],
	[IMPCONDITIONTYPE],
	[IMPQUALITY],
	[IMPABSTRACTCODE],
	[BLTASDESCRIPTION],
	[BLTASYEARBUILT],
	[PHYSICALAGE],
	[ADJUSTEDYEARBUILT],
	[EFFECTIVEAGE],
	[IMPEXTERIOR],
	[CLASSCODE],
	[IMPCOUNT],
	[BLTASTOTALUNITCOUNT],
	[ROOMCOUNT],
	[BEDROOMCOUNT],
	[BATHCOUNT],
	[FIXTURECOUNT],
	[TOTALIMPSF],
	[RESIDENTIALSF],
	[COMMERCIALSF],
	[CONDOIMPSF],
	[OUTBUILDINGSF],
	[IMPBLTASOTHER],
	[LANDNETSF],
	[MULTIPLEUSEFLAG],
	[LANDTYPE],
	[LANDABSTRACTCODE],
	[LANDCERTIFICATIONCODE],
	[LANDGROSSACRECOUNT],
	[LANDGROSSSF],
	[LANDGROSSFF],
	[LANDGROSSUNITCOUNT],
	[ZONINGCODE],
	[PLATTEDFLAG],
	[UNITNAME],
	[ACCTADJSALEVALUEPER],
	[TOTALLANDVALUETIMEOFSALE],
	[TOTALACCTVALUETIMEOFSALE],
	[PRIORYEARTAXROLLACTUALAMT],
	[PRIORYEARTAXROLLASSESSED],
	[LANDNETACRECOUNT],
	[HVACTYPE],
	[IMPUNITTYPE],
	[IMPINTERIOR],
	[ROOFCOVER],
	[ROOFTYPE],
	[INVENTORYOVERRIDEFLAG],
	[ZONEDAREA],
	[NBHDCODE1],
	[NBHDCODE2],
	[NBHDCODE3],
	[NBHDCODE4],
	[NBHDEXTENSION1],
	[NBHDEXTENSION2],
	[NBHDEXTENSION3],
	[NBHDEXTENSION4],
	[OCCCODE1],
	[OCCCODE2],
	[OCCCODE3],
	[ACCTADJSALEPRICE],
	[TIMEADJSALEPRICE],
	[DEEDCODE],
	[VALID1FLAG],
	[VALID2FLAG],
	[EXCLUDECODE1],
	[EXCLUDECODE2],
	[IMPROVEDFLAG],
	[CONFIRMEDFLAG],
	[BUSINESSNAME],
	[STREETNO],
	[PREDIRECTION],
	[STREETNAME],
	[STREETTYPE],
	[POSTDIRECTION],
	[PROPERTYCITY],
	[PROPERTYZIPCODE],
	[OUTBUILDINGCOUNT],
	[LANDEXCESSSF],
	[APPROACHTYPE],
	[FLOORCOVER],
	[CONDOIMPPERCENT],
	[FINALSF],
	[FINALSFVALUEPER],
	[ZONEDAREAVALUEPER],
	[GROUPINVENTORYFLAG],
	[GRANTORNAME1],
	[GRANTORNAME2],
	[GRANTORADDRESS1],
	[GRANTORADDRESS2],
	[GRANTORCITY],
	[GRANTORSTATECODE],
	[GRANTORZIPCODE],
	[SUBDIVISIONNAME],
	[LOT],
	[BLOCK],
	[FILINGNO],
	[TRACT],
	[LEGALDESCRIPTION],
	[GRANTEENAME1],
	[GRANTEENAME2],
	[GRANTEEADDRESS1],
	[GRANTEEADDRESS2],
	[GRANTEECITY],
	[GRANTEESTATECODE],
	[GRANTEEZIPCODE],
	[SALEINVENTORYON0],
	[SALEINVENTORYON1],
	[SALEINVENTORYON2],
	[OCCCODEDESCRIPTION1],
	[OCCCODEDESCRIPTION2],
	[OCCCODEDESCRIPTION3],
	[SALEINVENTORYOD0],
	[SALEINVENTORYOD1],
	[SALEINVENTORYOM0],
	[SALEINVENTORYOM1],
	[SALEINVENTORYOT0],
	[SALEINVENTORYOT1],
	[LANDNETFF],
	[JURISDICTIONID],
	[OUTOFAREASALEJURISDICTION],
	[LASTUPDATED],
	[GRANTEEPROVINCE],
	[GRANTEECOUNTRY],
	[GRANTEEPOSTALCODE],
	[OCCCOMPLETEDPCT],
	[PRIMARYUSECODE],
	[GRANTORPROVINCE],
	[GRANTORCOUNTRY],
	[GRANTORPOSTALCODE],
	[LANDNETUNITCOUNT],
	[TOTALFINISHEDSF],
	[TOTALUNFINISHEDSF],
	[BLTASCODE],
	[SALERATIO])
	    SELECT 
				'SALEDATE',
				'MUST BE A VALID DATE',
				'SALE DATE MUST BE A VALID SQL SERVER DATE',
				@lv_RUNTIME,
	[RECEPTIONNO],
	[ACCOUNTNO],
	[PARCELNO],
	[INVENTORYEFFECTIVEDATE],
	[SALEDATE],
	[SALEPRICE],
	[ADJSALEPRICE],
	[SALEVALUEPER],
	[ACCTTYPE],
	[ECONOMICAREACODE],
	[LEA],
	[SUBDIVISION],
	[VALUEAREACODE],
	[PROPERTYTYPE],
	[IMPCONDITIONTYPE],
	[IMPQUALITY],
	[IMPABSTRACTCODE],
	[BLTASDESCRIPTION],
	[BLTASYEARBUILT],
	[PHYSICALAGE],
	[ADJUSTEDYEARBUILT],
	[EFFECTIVEAGE],
	[IMPEXTERIOR],
	[CLASSCODE],
	[IMPCOUNT],
	[BLTASTOTALUNITCOUNT],
	[ROOMCOUNT],
	[BEDROOMCOUNT],
	[BATHCOUNT],
	[FIXTURECOUNT],
	[TOTALIMPSF],
	[RESIDENTIALSF],
	[COMMERCIALSF],
	[CONDOIMPSF],
	[OUTBUILDINGSF],
	[IMPBLTASOTHER],
	[LANDNETSF],
	[MULTIPLEUSEFLAG],
	[LANDTYPE],
	[LANDABSTRACTCODE],
	[LANDCERTIFICATIONCODE],
	[LANDGROSSACRECOUNT],
	[LANDGROSSSF],
	[LANDGROSSFF],
	[LANDGROSSUNITCOUNT],
	[ZONINGCODE],
	[PLATTEDFLAG],
	[UNITNAME],
	[ACCTADJSALEVALUEPER],
	[TOTALLANDVALUETIMEOFSALE],
	[TOTALACCTVALUETIMEOFSALE],
	[PRIORYEARTAXROLLACTUALAMT],
	[PRIORYEARTAXROLLASSESSED],
	[LANDNETACRECOUNT],
	[HVACTYPE],
	[IMPUNITTYPE],
	[IMPINTERIOR],
	[ROOFCOVER],
	[ROOFTYPE],
	[INVENTORYOVERRIDEFLAG],
	[ZONEDAREA],
	[NBHDCODE1],
	[NBHDCODE2],
	[NBHDCODE3],
	[NBHDCODE4],
	[NBHDEXTENSION1],
	[NBHDEXTENSION2],
	[NBHDEXTENSION3],
	[NBHDEXTENSION4],
	[OCCCODE1],
	[OCCCODE2],
	[OCCCODE3],
	[ACCTADJSALEPRICE],
	[TIMEADJSALEPRICE],
	[DEEDCODE],
	[VALID1FLAG],
	[VALID2FLAG],
	[EXCLUDECODE1],
	[EXCLUDECODE2],
	[IMPROVEDFLAG],
	[CONFIRMEDFLAG],
	[BUSINESSNAME],
	[STREETNO],
	[PREDIRECTION],
	[STREETNAME],
	[STREETTYPE],
	[POSTDIRECTION],
	[PROPERTYCITY],
	[PROPERTYZIPCODE],
	[OUTBUILDINGCOUNT],
	[LANDEXCESSSF],
	[APPROACHTYPE],
	[FLOORCOVER],
	[CONDOIMPPERCENT],
	[FINALSF],
	[FINALSFVALUEPER],
	[ZONEDAREAVALUEPER],
	[GROUPINVENTORYFLAG],
	[GRANTORNAME1],
	[GRANTORNAME2],
	[GRANTORADDRESS1],
	[GRANTORADDRESS2],
	[GRANTORCITY],
	[GRANTORSTATECODE],
	[GRANTORZIPCODE],
	[SUBDIVISIONNAME],
	[LOT],
	[BLOCK],
	[FILINGNO],
	[TRACT],
	[LEGALDESCRIPTION],
	[GRANTEENAME1],
	[GRANTEENAME2],
	[GRANTEEADDRESS1],
	[GRANTEEADDRESS2],
	[GRANTEECITY],
	[GRANTEESTATECODE],
	[GRANTEEZIPCODE],
	[SALEINVENTORYON0],
	[SALEINVENTORYON1],
	[SALEINVENTORYON2],
	[OCCCODEDESCRIPTION1],
	[OCCCODEDESCRIPTION2],
	[OCCCODEDESCRIPTION3],
	[SALEINVENTORYOD0],
	[SALEINVENTORYOD1],
	[SALEINVENTORYOM0],
	[SALEINVENTORYOM1],
	[SALEINVENTORYOT0],
	[SALEINVENTORYOT1],
	[LANDNETFF],
	[JURISDICTIONID],
	[OUTOFAREASALEJURISDICTION],
	[LASTUPDATED],
	[GRANTEEPROVINCE],
	[GRANTEECOUNTRY],
	[GRANTEEPOSTALCODE],
	[OCCCOMPLETEDPCT],
	[PRIMARYUSECODE],
	[GRANTORPROVINCE],
	[GRANTORCOUNTRY],
	[GRANTORPOSTALCODE],
	[LANDNETUNITCOUNT],
	[TOTALFINISHEDSF],
	[TOTALUNFINISHEDSF],
	[BLTASCODE],
	[SALERATIO]
			FROM [asr_staging].[s_tbnsaleinventory]
			WHERE SALEDATE IS NULL
			 OR CAST(SALEDATE AS DATE) NOT BETWEEN '1850-01-01' AND DATEADD(YEAR, 1, GETDATE())

------------------------------------------------------------------------------
	-- SALEPRICE – must be gt or = to zero

	INSERT INTO [dqm].[s_tbnsaleinventory_err]
	([COLUMN_NAME],
	[DQM_RULE],
	[ERROR_DESCRIPTION],
	[DQM_RUN_DATE],
	[RECEPTIONNO],
	[ACCOUNTNO],
	[PARCELNO],
	[INVENTORYEFFECTIVEDATE],
	[SALEDATE],
	[SALEPRICE],
	[ADJSALEPRICE],
	[SALEVALUEPER],
	[ACCTTYPE],
	[ECONOMICAREACODE],
	[LEA],
	[SUBDIVISION],
	[VALUEAREACODE],
	[PROPERTYTYPE],
	[IMPCONDITIONTYPE],
	[IMPQUALITY],
	[IMPABSTRACTCODE],
	[BLTASDESCRIPTION],
	[BLTASYEARBUILT],
	[PHYSICALAGE],
	[ADJUSTEDYEARBUILT],
	[EFFECTIVEAGE],
	[IMPEXTERIOR],
	[CLASSCODE],
	[IMPCOUNT],
	[BLTASTOTALUNITCOUNT],
	[ROOMCOUNT],
	[BEDROOMCOUNT],
	[BATHCOUNT],
	[FIXTURECOUNT],
	[TOTALIMPSF],
	[RESIDENTIALSF],
	[COMMERCIALSF],
	[CONDOIMPSF],
	[OUTBUILDINGSF],
	[IMPBLTASOTHER],
	[LANDNETSF],
	[MULTIPLEUSEFLAG],
	[LANDTYPE],
	[LANDABSTRACTCODE],
	[LANDCERTIFICATIONCODE],
	[LANDGROSSACRECOUNT],
	[LANDGROSSSF],
	[LANDGROSSFF],
	[LANDGROSSUNITCOUNT],
	[ZONINGCODE],
	[PLATTEDFLAG],
	[UNITNAME],
	[ACCTADJSALEVALUEPER],
	[TOTALLANDVALUETIMEOFSALE],
	[TOTALACCTVALUETIMEOFSALE],
	[PRIORYEARTAXROLLACTUALAMT],
	[PRIORYEARTAXROLLASSESSED],
	[LANDNETACRECOUNT],
	[HVACTYPE],
	[IMPUNITTYPE],
	[IMPINTERIOR],
	[ROOFCOVER],
	[ROOFTYPE],
	[INVENTORYOVERRIDEFLAG],
	[ZONEDAREA],
	[NBHDCODE1],
	[NBHDCODE2],
	[NBHDCODE3],
	[NBHDCODE4],
	[NBHDEXTENSION1],
	[NBHDEXTENSION2],
	[NBHDEXTENSION3],
	[NBHDEXTENSION4],
	[OCCCODE1],
	[OCCCODE2],
	[OCCCODE3],
	[ACCTADJSALEPRICE],
	[TIMEADJSALEPRICE],
	[DEEDCODE],
	[VALID1FLAG],
	[VALID2FLAG],
	[EXCLUDECODE1],
	[EXCLUDECODE2],
	[IMPROVEDFLAG],
	[CONFIRMEDFLAG],
	[BUSINESSNAME],
	[STREETNO],
	[PREDIRECTION],
	[STREETNAME],
	[STREETTYPE],
	[POSTDIRECTION],
	[PROPERTYCITY],
	[PROPERTYZIPCODE],
	[OUTBUILDINGCOUNT],
	[LANDEXCESSSF],
	[APPROACHTYPE],
	[FLOORCOVER],
	[CONDOIMPPERCENT],
	[FINALSF],
	[FINALSFVALUEPER],
	[ZONEDAREAVALUEPER],
	[GROUPINVENTORYFLAG],
	[GRANTORNAME1],
	[GRANTORNAME2],
	[GRANTORADDRESS1],
	[GRANTORADDRESS2],
	[GRANTORCITY],
	[GRANTORSTATECODE],
	[GRANTORZIPCODE],
	[SUBDIVISIONNAME],
	[LOT],
	[BLOCK],
	[FILINGNO],
	[TRACT],
	[LEGALDESCRIPTION],
	[GRANTEENAME1],
	[GRANTEENAME2],
	[GRANTEEADDRESS1],
	[GRANTEEADDRESS2],
	[GRANTEECITY],
	[GRANTEESTATECODE],
	[GRANTEEZIPCODE],
	[SALEINVENTORYON0],
	[SALEINVENTORYON1],
	[SALEINVENTORYON2],
	[OCCCODEDESCRIPTION1],
	[OCCCODEDESCRIPTION2],
	[OCCCODEDESCRIPTION3],
	[SALEINVENTORYOD0],
	[SALEINVENTORYOD1],
	[SALEINVENTORYOM0],
	[SALEINVENTORYOM1],
	[SALEINVENTORYOT0],
	[SALEINVENTORYOT1],
	[LANDNETFF],
	[JURISDICTIONID],
	[OUTOFAREASALEJURISDICTION],
	[LASTUPDATED],
	[GRANTEEPROVINCE],
	[GRANTEECOUNTRY],
	[GRANTEEPOSTALCODE],
	[OCCCOMPLETEDPCT],
	[PRIMARYUSECODE],
	[GRANTORPROVINCE],
	[GRANTORCOUNTRY],
	[GRANTORPOSTALCODE],
	[LANDNETUNITCOUNT],
	[TOTALFINISHEDSF],
	[TOTALUNFINISHEDSF],
	[BLTASCODE],
	[SALERATIO])
	    SELECT 
				'SALEPRICE',
				'FIELD DOES NOT ALLOW NEGATIVE NUMBER',
				'SALEPRICE MUST BE GREATER THAN OR EQUAL TO ZERO',
				@lv_RUNTIME,
	[RECEPTIONNO],
	[ACCOUNTNO],
	[PARCELNO],
	[INVENTORYEFFECTIVEDATE],
	[SALEDATE],
	[SALEPRICE],
	[ADJSALEPRICE],
	[SALEVALUEPER],
	[ACCTTYPE],
	[ECONOMICAREACODE],
	[LEA],
	[SUBDIVISION],
	[VALUEAREACODE],
	[PROPERTYTYPE],
	[IMPCONDITIONTYPE],
	[IMPQUALITY],
	[IMPABSTRACTCODE],
	[BLTASDESCRIPTION],
	[BLTASYEARBUILT],
	[PHYSICALAGE],
	[ADJUSTEDYEARBUILT],
	[EFFECTIVEAGE],
	[IMPEXTERIOR],
	[CLASSCODE],
	[IMPCOUNT],
	[BLTASTOTALUNITCOUNT],
	[ROOMCOUNT],
	[BEDROOMCOUNT],
	[BATHCOUNT],
	[FIXTURECOUNT],
	[TOTALIMPSF],
	[RESIDENTIALSF],
	[COMMERCIALSF],
	[CONDOIMPSF],
	[OUTBUILDINGSF],
	[IMPBLTASOTHER],
	[LANDNETSF],
	[MULTIPLEUSEFLAG],
	[LANDTYPE],
	[LANDABSTRACTCODE],
	[LANDCERTIFICATIONCODE],
	[LANDGROSSACRECOUNT],
	[LANDGROSSSF],
	[LANDGROSSFF],
	[LANDGROSSUNITCOUNT],
	[ZONINGCODE],
	[PLATTEDFLAG],
	[UNITNAME],
	[ACCTADJSALEVALUEPER],
	[TOTALLANDVALUETIMEOFSALE],
	[TOTALACCTVALUETIMEOFSALE],
	[PRIORYEARTAXROLLACTUALAMT],
	[PRIORYEARTAXROLLASSESSED],
	[LANDNETACRECOUNT],
	[HVACTYPE],
	[IMPUNITTYPE],
	[IMPINTERIOR],
	[ROOFCOVER],
	[ROOFTYPE],
	[INVENTORYOVERRIDEFLAG],
	[ZONEDAREA],
	[NBHDCODE1],
	[NBHDCODE2],
	[NBHDCODE3],
	[NBHDCODE4],
	[NBHDEXTENSION1],
	[NBHDEXTENSION2],
	[NBHDEXTENSION3],
	[NBHDEXTENSION4],
	[OCCCODE1],
	[OCCCODE2],
	[OCCCODE3],
	[ACCTADJSALEPRICE],
	[TIMEADJSALEPRICE],
	[DEEDCODE],
	[VALID1FLAG],
	[VALID2FLAG],
	[EXCLUDECODE1],
	[EXCLUDECODE2],
	[IMPROVEDFLAG],
	[CONFIRMEDFLAG],
	[BUSINESSNAME],
	[STREETNO],
	[PREDIRECTION],
	[STREETNAME],
	[STREETTYPE],
	[POSTDIRECTION],
	[PROPERTYCITY],
	[PROPERTYZIPCODE],
	[OUTBUILDINGCOUNT],
	[LANDEXCESSSF],
	[APPROACHTYPE],
	[FLOORCOVER],
	[CONDOIMPPERCENT],
	[FINALSF],
	[FINALSFVALUEPER],
	[ZONEDAREAVALUEPER],
	[GROUPINVENTORYFLAG],
	[GRANTORNAME1],
	[GRANTORNAME2],
	[GRANTORADDRESS1],
	[GRANTORADDRESS2],
	[GRANTORCITY],
	[GRANTORSTATECODE],
	[GRANTORZIPCODE],
	[SUBDIVISIONNAME],
	[LOT],
	[BLOCK],
	[FILINGNO],
	[TRACT],
	[LEGALDESCRIPTION],
	[GRANTEENAME1],
	[GRANTEENAME2],
	[GRANTEEADDRESS1],
	[GRANTEEADDRESS2],
	[GRANTEECITY],
	[GRANTEESTATECODE],
	[GRANTEEZIPCODE],
	[SALEINVENTORYON0],
	[SALEINVENTORYON1],
	[SALEINVENTORYON2],
	[OCCCODEDESCRIPTION1],
	[OCCCODEDESCRIPTION2],
	[OCCCODEDESCRIPTION3],
	[SALEINVENTORYOD0],
	[SALEINVENTORYOD1],
	[SALEINVENTORYOM0],
	[SALEINVENTORYOM1],
	[SALEINVENTORYOT0],
	[SALEINVENTORYOT1],
	[LANDNETFF],
	[JURISDICTIONID],
	[OUTOFAREASALEJURISDICTION],
	[LASTUPDATED],
	[GRANTEEPROVINCE],
	[GRANTEECOUNTRY],
	[GRANTEEPOSTALCODE],
	[OCCCOMPLETEDPCT],
	[PRIMARYUSECODE],
	[GRANTORPROVINCE],
	[GRANTORCOUNTRY],
	[GRANTORPOSTALCODE],
	[LANDNETUNITCOUNT],
	[TOTALFINISHEDSF],
	[TOTALUNFINISHEDSF],
	[BLTASCODE],
	[SALERATIO]
			FROM [asr_staging].[s_tbnsaleinventory]
			WHERE SALEPRICE < 0;
		

            END




		END